<div class="create-ticket-container">
  <div class="form-header">
    <h2>Create New Support Ticket</h2>
    <p>Submit a new support request to the EOSC Beyond helpdesk team</p>
  </div>

  <div *ngIf="success" class="success-message">
    <i class="fas fa-check-circle"></i>
    <span>Ticket created successfully! Redirecting to your tickets...</span>
  </div>

  <div *ngIf="error" class="error-message">
    <i class="fas fa-exclamation-circle"></i>
    <span>{{ error }}</span>
  </div>

  <form [formGroup]="ticketForm" (ngSubmit)="onSubmit()" class="ticket-form">
    <div *ngIf="error" class="error-message">{{ error }}</div>
    <div *ngIf="success" class="success-message">Ticket created successfully!</div>

    <!-- Section 1: Customer Information -->
    <div class="form-section">
      <h3 class="section-title">Customer Information</h3>
      
    <div class="form-group">
        <label for="customerFirstname">Customer Firstname <span class="required">*</span></label>
        <input id="customerFirstname" type="text" formControlName="customerFirstname" />
        <div class="validation-error" *ngIf="ticketForm.get('customerFirstname')?.invalid && (ticketForm.get('customerFirstname')?.dirty || ticketForm.get('customerFirstname')?.touched)">
          {{ getErrorMessage('customerFirstname') }}
        </div>
      </div>

      <div class="form-group">
        <label for="customerLastname">Customer Lastname <span class="required">*</span></label>
        <input id="customerLastname" type="text" formControlName="customerLastname" />
        <div class="validation-error" *ngIf="ticketForm.get('customerLastname')?.invalid && (ticketForm.get('customerLastname')?.dirty || ticketForm.get('customerLastname')?.touched)">
          {{ getErrorMessage('customerLastname') }}
      </div>
    </div>

    <div class="form-group">
        <label for="customerEmail">Customer Email address <span class="required">*</span></label>
        <input id="customerEmail" type="email" formControlName="customerEmail" />
        <div class="validation-error" *ngIf="ticketForm.get('customerEmail')?.invalid && (ticketForm.get('customerEmail')?.dirty || ticketForm.get('customerEmail')?.touched)">
          {{ getErrorMessage('customerEmail') }}
        </div>
      </div>
    </div>

    <!-- Section 2: Ticket Information -->
    <div class="form-section">
      <h3 class="section-title">Ticket Information</h3>
      
      <div class="form-group">
        <label for="title">Title <span class="required">*</span></label>
        <input id="title" type="text" formControlName="title" />
        <div class="validation-error" *ngIf="ticketForm.get('title')?.invalid && (ticketForm.get('title')?.dirty || ticketForm.get('title')?.touched)">
          {{ getErrorMessage('title') }}
        </div>
      </div>

      <div class="form-group">
        <label for="group">Group</label>
        <input id="group" type="text" formControlName="group" />
      </div>

      <div class="form-group">
        <label for="articleSubject">Subject</label>
        <input id="articleSubject" type="text" formControlName="articleSubject" />
      </div>

      <div class="form-group">
        <label for="articleBody">Message <span class="required">*</span></label>
        <textarea id="articleBody" formControlName="articleBody"></textarea>
        <div class="validation-error" *ngIf="ticketForm.get('articleBody')?.invalid && (ticketForm.get('articleBody')?.dirty || ticketForm.get('articleBody')?.touched)">
          {{ getErrorMessage('articleBody') }}
        </div>
      </div>

      <div class="form-group">
        <label for="articleType">Type</label>
        <select id="articleType" formControlName="articleType">
          <option value="note">Note</option>
          <option value="question">Question</option>
          <option value="incident">Incident</option>
        </select>
      </div>

      <div class="form-group">
        <label>
          <input type="checkbox" formControlName="articleInternal" /> Internal Note
        </label>
      </div>
    </div>

    <button type="submit" [disabled]="loading || ticketForm.invalid">Submit Ticket</button>
    <div *ngIf="loading" class="loading-message">Submitting...</div>
    <div class="mandatory-note">Fields with <span class="required">*</span> are mandatory and must be completed in order to submit this form.</div>
  </form>

  <div class="help-info">
    <h4><i class="fas fa-info-circle"></i> Tips for better support</h4>
    <ul>
      <li>Provide clear and specific information about your issue</li>
      <li>Include any error messages or screenshots if applicable</li>
      <li>Mention the steps you've already tried to resolve the issue</li>
      <li>Specify which service or resource you're having trouble with</li>
    </ul>
  </div>
</div> 